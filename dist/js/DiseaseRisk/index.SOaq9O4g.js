import{z as e,q as a,v as t,H as l,J as o,G as s,N as n,O as i,M as r,F as u,b as d,a0 as c,c as v,r as p,S as m,P as b,V as h,_ as y,X as g}from"../@vue/@vue.CISUW6gm.js";import{a as f}from"../vue-router/vue-router.DzNGWVxd.js";import{_ as k,F as C}from"../../assets/index-BGBnUB5j.js";import{Q as x,A as q,a as j}from"../QuestionCard/QuestionCard.CFg0l9jm.js";import{L as w}from"../Loading/Loading.Kc0FP4fC.js";import"../crypto-js/crypto-js.7wHo0WA-.js";import"../EncryptStorage/EncryptStorage.CPcoWq5g.js";import"../pinia/pinia.BbQN6uKc.js";import"../js-cookie/js-cookie.BXEMiIsG.js";import"../bootstrap/bootstrap.B479eVIA.js";import"../@popperjs/@popperjs.CDLgd9d9.js";import"../clipboard/clipboard.BDF08mEv.js";import"../vue3-lottie/vue3-lottie.CcJZhO04.js";import"../lottie-web/lottie-web.CrP6allm.js";import"../encrypt-storage/encrypt-storage.Bu0T6VU1.js";const _={class:"bg_DiseaseRisk_color"},I={ref:"formline",class:"form_container",novalidate:""},Q=["id"],L={class:"form-label"},$={key:0,class:"showError-feedback"},R={class:"box-check"},S=["name","id","value","onUpdate:modelValue","onInput","onChange","required"],N=["for"],O=["name","id","placeholder","onUpdate:modelValue","onInput","onChange","required","inputmode"],E={class:"submit_container"},U={class:"bar_content"},V=["max","value"],F={class:"bar_content-text"},H={key:1,class:"arrows_content"},D=k({__name:"index",setup(k){const D=f(),B=d(!1),M=d(""),P=d(null),J=d(!0),z=d([]),A=d(null),G=d({}),K=d({}),T=p({}),X=d(!1),Y=v(()=>({max:z.value.length,min:Object.keys(T).length})),W=()=>{X.value=!0,A.value.scrollIntoView({behavior:"smooth",block:"start"})};function Z(e){B.value=e}z.value=[{Code:"Q1",Context:"年齡",type:"input",placeholder:"輸入年齡(範圍 30~100 歲)",required:!0,validate:"int"},{Code:"Q2",Context:"生理性別",type:"radio",answerList:[{label:"男性",val:1},{label:"女性",val:2}],required:!0,validate:"int"},{Code:"Q3",Context:"糖尿病家族史",type:"radio",answerList:[{label:"有",val:1},{label:"沒有",val:0}],required:!0,validate:"int"},{Code:"Q4",Context:"抽煙",type:"radio",answerList:[{label:"有",val:1},{label:"沒有",val:0}],required:!0,validate:"int"},{Code:"Q5",Context:"身高",type:"input",placeholder:"輸入身高(範圍 100~220 公分)",required:!0,validate:"double"},{Code:"Q6",Context:"體重",type:"input",placeholder:"輸入體重(範圍 30~200 公斤)",required:!0,validate:"double"},{Code:"Q7",Context:"腰圍",type:"input",placeholder:"輸入腰圍(整數，範圍 40~150)",required:!0,validate:"int"},{Code:"Q8",Context:"血壓：收縮壓 systolic_bp",type:"input",placeholder:"輸入收縮壓(整數，範圍 80~250 mmHg)",required:!0,validate:"int"},{Code:"Q9",Context:"白血球 wbc",type:"input",placeholder:"輸入白血球(範圍 2000~30000 ul)",required:!1,validate:"double"},{Code:"Q10",Context:"三酸甘油脂 tg",type:"input",placeholder:"輸入三酸甘油脂(範圍 0~1000 mg/dL)",required:!1,validate:"double"},{Code:"Q11",Context:"高密度脂蛋白 hdl",type:"input",placeholder:"輸入高密度脂蛋白(範圍 0~100 mg/dL)",required:!1,validate:"double"},{Code:"Q12",Context:"飯前血糖 glucose",type:"input",placeholder:"輸入飯前血糖(範圍 0~500 mg/dL)",required:!1,validate:"double"}];const ee=v(()=>{let e=!0;return z.value.forEach((a,t)=>{null==T[t]&&a.required&&(e=!1)}),e}),ae=()=>{G.value={},z.value.forEach((e,a)=>{null==T[a]&&e.required&&(G.value[a]=!0,K.value[a]="必填項目")})};e(()=>{(()=>{const e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting?X.value=!0:X.value=!1})},{root:null,rootMargin:"0px",threshold:.01});A.value&&e.observe(A.value),c(()=>{A.value&&e.unobserve(A.value)})})()});const te=()=>{ae();const e=z.value.findIndex((e,a)=>void 0===T[a]&&1==e.required);console.log(e,"nextUnansweredIndex 第"+(e+1)+"題，沒填"),-1!==e&&oe(e)},le=()=>{ae();let e=z.value.findLastIndex((e,a)=>void 0===T[a]&&e.required);console.log(e,"prevUnansweredIndex 第"+(e+1)+"題，沒填"),-1!==e&&oe(e)},oe=e=>{const a=document.getElementById(`question-${e}`);a&&a.scrollIntoView({behavior:"smooth",block:"start"})},se=e=>{let a=z.value[e].validate;"int"==a?/^\d*$/.test(T[e])||(isNaN(parseInt(T[e]))?delete T[e]:T[e]=parseInt(T[e])):"double"==a&&(/^[0-9.]+$/.test(T[e])||delete T[e])},ne=e=>{let a=z.value[e].validate;"int"==a?isNaN(parseInt(T[e]))?delete T[e]:T[e]=parseInt(T[e]):"double"==a&&(isNaN(parseFloat(T[e]))?delete T[e]:T[e]=parseFloat(T[e])),null!=T[e]&&(G.value[e]=!1,delete K.value[e])},ie=(e,a)=>{switch(+e){case 0:(a<30||a>120)&&(G.value[e]=!0,K.value[e]="年齡不符合，需為30~120歲");break;case 4:(a<100||a>220)&&(G.value[e]=!0,K.value[e]="身高不符合，需為100~220公分");break;case 5:(a<30||a>200)&&(G.value[e]=!0,K.value[e]="體重不符合，需為30~200公斤");break;case 6:(a<40||a>150)&&(G.value[e]=!0,K.value[e]="腰圍不符合，需為40~150");break;case 7:(a<80||a>250)&&(G.value[e]=!0,K.value[e]="收縮壓不符合，需為80~250mmHg");break;case 8:(a<2e3||a>3e4)&&(G.value[e]=!0,K.value[e]="白血球不符合，需為2000~30000ul");break;case 9:(a<0||a>1e3)&&(G.value[e]=!0,K.value[e]="三酸甘油脂不符合，需為0~1000 mg/dL");break;case 10:(a<0||a>100)&&(G.value[e]=!0,K.value[e]="高密度脂蛋白不符合，需為0~100mg/dL");break;case 11:(a<0||a>500)&&(G.value[e]=!0,K.value[e]="飯前血糖不符合，需為0~500mg/dL")}};let re={};const ue=()=>{if((()=>{G.value={},K.value={};let e=8;z.value.length==Object.keys(T).length&&(e=12);for(const[a,t]of Object.entries(T))a<e&&(console.log(`${a}: ${t}`),ie(a,t))})(),Object.keys(K.value).length>0){let e=Object.keys(K.value)[0];return void oe(e)}J.value=!1,re={age:T[0],sex:T[1],familyHistory:1===T[2],smoker:1===T[3],height:T[4],weight:T[5],waist:T[6],systolicBp:T[7],wbc:T[8]??0,tg:T[9]??0,hdl:T[10]??0,glucose:T[11]??0},setTimeout(()=>{sessionStorage.setItem("RiskParams",JSON.stringify(re)),J.value=!0,D.push({name:"RiskQuestionnaireResult"})},1e3)};return(e,d)=>(a(),t(u,null,[l(w,{IsShow:J.value},null,8,["IsShow"]),l(C,{ref_key:"Failedref",ref:P,IsShow:B.value,Content:M.value,onClose:Z},null,8,["IsShow","Content"]),o("div",_,[o("div",{class:"banner"},[o("div",null,[d[0]||(d[0]=o("img",{src:"/healthspy/assets/img_DiseaseRisk-BHPyRYUS.png",alt:"疾病風險評估"},null,-1)),o("a",{class:"btn btn-spy",onClick:W,style:{"max-width":"284px"}},"開始檢測")])]),o("div",{id:"DiseaseRisk",ref_key:"DiseaseRisk",ref:A,style:{"padding-top":"8px"}},[l(x,null,{title:s(()=>[...d[1]||(d[1]=[b(" 疾病風險預測 ",-1)])]),default:s(()=>[o("form",I,[(a(!0),t(u,null,m(z.value,(l,s)=>(a(),t("div",{key:l.Context,class:"form_container_div",id:`question-${s}`},[o("label",L,[b(r(s+1<10?"0"+(s+1):s+1)+" "+r(l.Context)+" ",1),G.value[s]?(a(),t("div",$,r(K.value[s]),1)):h("",!0)]),"radio"==l.type?(a(!0),t(u,{key:0},m(l.answerList,(e,i)=>(a(),t("div",{class:"form-check",key:e.label},[o("div",R,[n(o("input",{class:"form-check-input",type:"radio",name:`question-${s}`,id:`inlineRadio-${s}-${i}`,value:e.val,"onUpdate:modelValue":e=>T[s]=e,onInput:e=>se(s),onChange:e=>ne(s),autocomplete:"off",required:l.required},null,40,S),[[y,T[s]]]),o("label",{class:"form-check-label btn btn-secondar box_check",for:`inlineRadio-${s}-${i}`},r(e.label),9,N)])]))),128)):"input"==l.type?(a(),t(u,{key:1},[d[2]||(d[2]=o("div",null,null,-1)),n(o("input",{class:"form-control form-input shadow-none",type:"text",name:`question-${s}`,id:`inlineRadio-${s}-${e.index}`,placeholder:l.placeholder,"onUpdate:modelValue":e=>T[s]=e,onInput:e=>se(s),onChange:e=>ne(s),autocomplete:"off",required:l.required,inputmode:"int"==l.validate?"numeric":"decimal"},null,40,O),[[g,T[s]]])],64)):h("",!0)],8,Q))),128))],512)]),_:1})],512),n(o("div",E,[o("div",U,[o("progress",{class:"progress_class",max:Y.value.max,value:Y.value.min},null,8,V),o("span",F,r(Y.value.min)+" / "+r(Y.value.max),1)]),Y.value.min>=8&&ee.value?(a(),t("button",{key:0,class:"btn btn_submit",type:"submit",onClick:ue}," 查看結果 ")):(a(),t("div",H,[o("button",{class:"btn_arrows",type:"button",onClick:le},[l(q)]),o("button",{class:"btn_arrows",type:"button",onClick:te},[l(j)])]))],512),[[i,X.value]])])],64))}},[["__scopeId","data-v-9f0b222c"]]);export{D as default};
