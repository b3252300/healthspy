import"../EncryptStorage/EncryptStorage.CPcoWq5g.js";import{G as e,V as a}from"../user/user.4omUNN0x.js";import{h as t}from"../request/request.DS25iEu1.js";import{F as o,r as s,p as r}from"../../assets/index-Ba86HNo9.js";import{u as l}from"../vue-router/vue-router.B-TQU50p.js";import{L as u}from"../Loading/Loading.Da43D_ay.js";import{y as i,q as p,v as n,H as m,F as c,b as h}from"../@vue/@vue.CISUW6gm.js";import"../encrypt-storage/encrypt-storage.Bu0T6VU1.js";import"../axios/axios.CmLmLvTV.js";import"../crypto-js/crypto-js.7wHo0WA-.js";import"../clipboard/clipboard.BDF08mEv.js";import"../pinia/pinia.BbQN6uKc.js";import"../js-cookie/js-cookie.BXEMiIsG.js";import"../bootstrap/bootstrap.B479eVIA.js";import"../@popperjs/@popperjs.CDLgd9d9.js";import"../vue3-lottie/vue3-lottie.CcJZhO04.js";import"../lottie-web/lottie-web.CrP6allm.js";const v={__name:"validation",setup(v){const{Logout:d}=r(),f=l(),j=h(""),S=h(!1),g=h(null),y=h(!1),b=h("");S.value&&(S.value=!1),i(()=>{j.value=f.params.rowId});let I={RowId:j.value};console.log(j.value);const w=()=>{S.value&&(S.value=!1),a(I).then(e=>{const{code:a,data:o}=e;if(0==a)if(void 0!==f.params.rowId&&localStorage.setItem("rowId",j.value),o.Token)if("NhmcList"===f.params.action)s.push({path:"/member/nhmc/Schedule"});else if("HealthSurvey"===f.params.action){(function(e){return t.request({method:"post",url:"/api/FrontendHealthScore/HaveSurveyResult",data:e})})({}).then(e=>{console.log(e,"HaveSurveyResult");const{code:a,message:t,data:o}=e;0==a?(S.value&&(S.value=!1),o.IsSurveyResult?s.push({path:"/member/HealthSurvey/Result"}):s.push({path:"/member/HealthSurvey/index"})):(y.value=!0,b.value=t)})}else if("DiseaseRisk"===f.params.action){(function(e){return t.request({method:"post",url:"/api/FrontendDiseaseRisk/HasData",data:e})})({}).then(e=>{const{code:a,message:t,data:o}=e;console.log(e,"HasData"),0==a?0==o.DataSource?s.push({path:"/member/DiseaseRisk/index"}):1==o.DataSource?s.push({path:"/member/DiseaseRisk/Result"}):2==o.DataSource?s.push({path:"/member/DiseaseRisk/NationalResult"}):s.push({path:"/404"}):(y.value=!0,b.value=t)})}else alert("無法辨識"+f.params.rowId),s.push({path:"/404"});else alert("沒有 Token"),window.location.href=d.path;else alert("Token 失敗("+a+")"),s.push({path:"/404"})})},R=h(""),k=h("");let D=localStorage.getItem("refreshCount")||0;function H(e){y.value=e}return e({}).then(e=>{const{code:a,data:t}=e;0==a&&(R.value=t.Version,k.value="1.2409.0901",console.log(e),R.value!==k.value?(D++,localStorage.setItem("refreshCount",D),D<=2?(S.value&&(S.value=!1),location.reload(!0)):w()):w())}).finally(()=>{}),(e,a)=>(p(),n(c,null,[m(u,{IsShow:S.value},null,8,["IsShow"]),m(o,{ref_key:"Failedref",ref:g,IsShow:y.value,Content:b.value,onClose:H},null,8,["IsShow","Content"])],64))}};export{v as default};
